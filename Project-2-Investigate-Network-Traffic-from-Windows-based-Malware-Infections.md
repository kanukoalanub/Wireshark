# Investigating Network Traffic from Windows based Malware Infections

## Introduction

In this project, we cover how to use Wireshark to investigate network traffic from Windows based malware infections.

## Lab Set-up and Tools

1. **Tool**: Wireshark v4.2.6
2. **Sample PCAP File**: Download a sample PCAP file containing malware traffic for analysis.

## Exercises

### Exercise 1: One method to Identify Host name through DHCP Traffic

#### Steps

1. Open Wireshark.
2. Go to "File" > "Open" and select the sample PCAP file you downloaded.
3. The file will load, and the captured traffic will be displayed.
4. Filter the file by typing DHCP.

#### Expected Output

- The sample PCAP file containing DHCP traffic loaded in Wireshark.
- That displays host name under the Dynamic Host Configuration Protocol details section in the Frames detail section.

![Screenshot 2024-08-04 012143](https://github.com/user-attachments/assets/327704b7-aa34-4213-abe5-0a4d20a22d8f)

### Exercise 2: Identify Windows/macOS Hosts name through NBNS Traffic

#### Steps

1. Open Wireshark.
2. Go to "File" > "Open" and select the sample PCAP file you downloaded.
3. The file will load, and the captured traffic will be displayed.
4. Filter the file by typing NBNS.

#### Expected Output

- The sample PCAP file containing NBNS traffic loaded in Wireshark.
- That displays host name in the Ethernet II details section in the Frames detail section.



### Exercise 3: Analyze Malicious Traffic

#### Steps

1. Select a packet that appears suspicious based on your initial analysis.
2. Click on the packet to view its details in the packet details pane.
3. Expand the relevant protocol sections to examine the details of the packet, such as headers, payload data, and any anomalies.

#### Expected Output

- Detailed information about a suspicious packet analyzed.

### Exercise 4: Follow the Malware's Communication Stream

#### Steps

1. Right-click on a suspicious packet and select "Follow" > "TCP Stream" or "UDP Stream" to view the entire conversation.
2. Analyze the conversation for indicators of malicious activity, such as unusual commands, encoded data, or unexpected file transfers.

#### Expected Output

- A complete communication stream of the malware analyzed.

### Exercise 5: Document and Report Findings

#### Steps

1. Take notes on the suspicious activities and patterns you identified in the traffic.
2. Document key findings, including IP addresses, ports, payload data, and any other relevant details.
3. Summarize your findings in a report format, which can be used for further investigation or as part of a security incident report.

#### Expected Output

- A detailed report documenting the findings from your malware traffic analysis.

## Conclusion

By completing these exercises, you have learned how to detect and investigate malware traffic using Wireshark. These skills are essential for identifying malicious network behavior, responding to security incidents, and protecting network infrastructure.
